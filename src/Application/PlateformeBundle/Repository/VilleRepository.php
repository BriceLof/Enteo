<?php

namespace Application\PlateformeBundle\Repository;

//use Doctrine\ORM\QueryBuilder;
use Doctrine\ORM\Query\ResultSetMappingBuilder;

/**
 * VilleRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class VilleRepository extends \Doctrine\ORM\EntityRepository
{
    //recupere les villes par rapport au deux premiers chiffres du code postal
    public function findByDepartement($departement)
    {
        $queryBuilder = $this->createQueryBuilder("v")
                ->where("v.cp LIKE :departement")
                ->setParameter("departement", $departement.'%')
                ->orderBy("v.nom", "ASC");
        $query = $queryBuilder->getQuery();
        $results = $query->getResult();
        return $results;
        
    }

    public function getVilles($nomVille){
        $queryBuilder = $this->createQueryBuilder("v")
            ->where("v.nom LIKE :nomVille")
            ->setParameter("nomVille", '%'.$nomVille.'%')
            ->setMaxResults(10);
        $query = $queryBuilder->getQuery();
        $results = $query->getResult();
        return $results;
    }

    //recupere les villes par rapport au nom du departement
    public function getVillesByDpt($dpt){
        $queryBuilder = $this->createQueryBuilder("v")
            ->where("v.dpt LIKE :departement")
            ->setParameter("departement", $dpt.'%')
            ->orderBy("v.nom", "ASC");
        $query = $queryBuilder->getQuery();
        $results = $query->getResult();
        return $results;
    }
}
